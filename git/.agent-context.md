# Git Compartment Context
> **Scope**: Repository operations and Worktree automaton.

## üéØ Mission
Safe execution of Git commands. Automates branch management, worktree creation for isolated tasks, and provides structured repository status reports for the bot.

## üó∫Ô∏è Key Filepaths
- `handler.ts`: Core logic for `git worktree` automation and porcelain status parsing.
- `process-manager.ts`: Logic for tracking long-running git processes and ensuring cleanup.
- `command.ts`: Slash command handlers for `/git` (status, branch, commit, push, worktree).

## üõ†Ô∏è Key Dependencies
- `node:child_process`: Used for command execution via `exec` (promisified).
- `Deno.Command`: For modern streaming execution in specific contexts.

## üìú Conventions
- **Isolated Execution**: Always specify `cwd` to avoid accidental mutation of the wrong repository.
- **Safety**: Environmental isolation (`GIT_TERMINAL_PROMPT=0`) to prevent blocking on interactive prompts.
- **Path Sanitization**: Use `sanitizeChannelName` to ensure branch names are Discord-safe.

## üí° Code Example: Safe Git Exec
```typescript
export async function executeGitCommand(workDir: string, command: string): Promise<string> {
  try {
    const { stdout, stderr } = await exec(command, { 
      cwd: workDir,
      env: { ...process.env, GIT_TERMINAL_PROMPT: '0' }
    });
    return stdout || stderr || "Success.";
  } catch (error: any) {
    return `Error: ${error.message}\n${error.stderr || ''}`;
  }
}
```
